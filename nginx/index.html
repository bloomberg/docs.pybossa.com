
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <link rel="shortcut icon" href="../images/favicon.icon">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.10.1">
    
    
      
        <title>Nginx - PYBOSSA Documentation</title>
      
    
    
      <script src="../assets/javascripts/modernizr-e826f8942a.js"></script>
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-a3ed30f4c1.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source Sans Pro:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="#087da1" data-md-color-accent="#00a889">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="PYBOSSA Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon md-icon--home"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Nginx
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="" data-md-lang-tokenizer="[\s\-]+">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/Scifabric/pybossa" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Scifabric/pybossa
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <div class="md-nav__button md-logo">
      
        <i class="md-icon md-icon--home"></i>
      
    </div>
    PYBOSSA Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Scifabric/pybossa" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Scifabric/pybossa
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../admin/" title="Admin" class="md-nav__link">
      Admin
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../api/" title="Api" class="md-nav__link">
      Api
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../build_with_pybossa/" title="Build with pybossa" class="md-nav__link">
      Build with pybossa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../customizing/" title="Customizing" class="md-nav__link">
      Customizing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="Faq" class="md-nav__link">
      Faq
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../importers/" title="Importers" class="md-nav__link">
      Importers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../install/" title="Install" class="md-nav__link">
      Install
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installing_pybossa/" title="Installing pybossa" class="md-nav__link">
      Installing pybossa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../model/" title="Model" class="md-nav__link">
      Model
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Nginx
      </label>
    
    <a href="./" title="Nginx" class="md-nav__link md-nav__link--active">
      Nginx
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#first-steps" title="First steps" class="md-nav__link">
    First steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-nginx-and-uwsgi" title="Installing nginx and uwsgi" class="md-nav__link">
    Installing nginx and uwsgi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-nginx-and-uwsgi-for-pybossa" title="Configuring nginx and uwsgi for PYBOSSA" class="md-nav__link">
    Configuring nginx and uwsgi for PYBOSSA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-pybossaini-file-for-uwsgi" title="Creating the pybossa.ini file for uwsgi" class="md-nav__link">
    Creating the pybossa.ini file for uwsgi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-supervisord" title="Install supervisord" class="md-nav__link">
    Install supervisord
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-redis-and-sentinel-as-service-with-supervisord" title="Configure Redis and sentinel as service with supervisord" class="md-nav__link">
    Configure Redis and sentinel as service with supervisord
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-rq-scheduler-and-worker-to-run-with-supervisord" title="Configure RQ-Scheduler and -Worker to run with supervisord" class="md-nav__link">
    Configure RQ-Scheduler and -Worker to run with supervisord
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-pybossa-itself" title="Setup PYBOSSA itself" class="md-nav__link">
    Setup PYBOSSA itself
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#let-pybossa-run-as-service" title="Let PYBOSSA run as service" class="md-nav__link">
    Let PYBOSSA run as service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-update-pybossa-service" title="How to update PYBOSSA service" class="md-nav__link">
    How to update PYBOSSA service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logs-of-pybossa-services" title="Logs of PYBOSSA services" class="md-nav__link">
    Logs of PYBOSSA services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#last-words-about-security-and-scaling" title="Last words about Security and Scaling" class="md-nav__link">
    Last words about Security and Scaling
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../plugins/" title="Plugins" class="md-nav__link">
      Plugins
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../translating/" title="Translating" class="md-nav__link">
      Translating
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../vagrant_pybossa/" title="Vagrant pybossa" class="md-nav__link">
      Vagrant pybossa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      Changelog
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        Changelog
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v0.2.3/" title="V0.2.3" class="md-nav__link">
      V0.2.3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.0.0/" title="V1.0.0" class="md-nav__link">
      V1.0.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.1.0/" title="V1.1.0" class="md-nav__link">
      V1.1.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.1.1/" title="V1.1.1" class="md-nav__link">
      V1.1.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.1.2/" title="V1.1.2" class="md-nav__link">
      V1.1.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.1.3/" title="V1.1.3" class="md-nav__link">
      V1.1.3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.2.0/" title="V1.2.0" class="md-nav__link">
      V1.2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.2.1/" title="V1.2.1" class="md-nav__link">
      V1.2.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.2.2/" title="V1.2.2" class="md-nav__link">
      V1.2.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.3.0/" title="V1.3.0" class="md-nav__link">
      V1.3.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.4.0/" title="V1.4.0" class="md-nav__link">
      V1.4.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.4.1/" title="V1.4.1" class="md-nav__link">
      V1.4.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.5.0/" title="V1.5.0" class="md-nav__link">
      V1.5.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.5.1/" title="V1.5.1" class="md-nav__link">
      V1.5.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.6.0/" title="V1.6.0" class="md-nav__link">
      V1.6.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.6.1/" title="V1.6.1" class="md-nav__link">
      V1.6.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v1.6.2/" title="V1.6.2" class="md-nav__link">
      V1.6.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v2.0.0/" title="V2.0.0" class="md-nav__link">
      V2.0.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v2.1.0/" title="V2.1.0" class="md-nav__link">
      V2.1.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v2.2.0/" title="V2.2.0" class="md-nav__link">
      V2.2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v2.2.1/" title="V2.2.1" class="md-nav__link">
      V2.2.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v2.3.0/" title="V2.3.0" class="md-nav__link">
      V2.3.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../changelog/v2.3.8/" title="V2.3.8" class="md-nav__link">
      V2.3.8
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18">
    
    <label class="md-nav__link" for="nav-18">
      User
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        User
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../user/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user/pbs/" title="Pbs" class="md-nav__link">
      Pbs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user/project_settings/" title="Project settings" class="md-nav__link">
      Project settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user/tutorial/" title="Tutorial" class="md-nav__link">
      Tutorial
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#first-steps" title="First steps" class="md-nav__link">
    First steps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-nginx-and-uwsgi" title="Installing nginx and uwsgi" class="md-nav__link">
    Installing nginx and uwsgi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-nginx-and-uwsgi-for-pybossa" title="Configuring nginx and uwsgi for PYBOSSA" class="md-nav__link">
    Configuring nginx and uwsgi for PYBOSSA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-the-pybossaini-file-for-uwsgi" title="Creating the pybossa.ini file for uwsgi" class="md-nav__link">
    Creating the pybossa.ini file for uwsgi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-supervisord" title="Install supervisord" class="md-nav__link">
    Install supervisord
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-redis-and-sentinel-as-service-with-supervisord" title="Configure Redis and sentinel as service with supervisord" class="md-nav__link">
    Configure Redis and sentinel as service with supervisord
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-rq-scheduler-and-worker-to-run-with-supervisord" title="Configure RQ-Scheduler and -Worker to run with supervisord" class="md-nav__link">
    Configure RQ-Scheduler and -Worker to run with supervisord
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-pybossa-itself" title="Setup PYBOSSA itself" class="md-nav__link">
    Setup PYBOSSA itself
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#let-pybossa-run-as-service" title="Let PYBOSSA run as service" class="md-nav__link">
    Let PYBOSSA run as service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-update-pybossa-service" title="How to update PYBOSSA service" class="md-nav__link">
    How to update PYBOSSA service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logs-of-pybossa-services" title="Logs of PYBOSSA services" class="md-nav__link">
    Logs of PYBOSSA services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#last-words-about-security-and-scaling" title="Last words about Security and Scaling" class="md-nav__link">
    Last words about Security and Scaling
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="deploying-pybossa-with-nginx-and-uwsgi">Deploying PYBOSSA with nginx and uwsgi</h1>
<p>PYBOSSA is a python web application built using the Flask
micro-framework.</p>
<p>This guide describes how to make PYBOSSA run as a service or daemon
permanently in the background. This is useful if you want to run a
production ready single PYBOSSA web server. If you only want to test
PYBOSSA please follow only install.</p>
<p>Pre-requisites:</p>
<ul>
<li>nginx</li>
<li>uwsgi</li>
<li>supervisord</li>
<li>Redis and sentinel as service (with supervisord)</li>
<li>RQ-Scheduler and RQ-Worker as service (with supervisord)</li>
<li>PYBOSSA as service (with supervisord)</li>
</ul>
<h2 id="first-steps">First steps</h2>
<p>If you have not done already: Please create a new user account, e.g.
pybossa (a non root at best) which will run the PYBOSSA instance. You
then have to follow the instructions from install first to get a
runnable PYBOSSA. After you&rsquo;ve done that please continue with this
guide.</p>
<h2 id="installing-nginx-and-uwsgi">Installing nginx and uwsgi</h2>
<p>You have to install nginx and uwsgi in your server machine. In a
Debian/Ubuntu machine you can install them running the following
commands:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo apt-get install nginx
</pre></div>
</td></tr></table></p>
<p>in the (virtualenv-)installation directory of pybossa you need to
install uwsgi:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>pip install -U uwsgi
</pre></div>
</td></tr></table>

<h2 id="configuring-nginx-and-uwsgi-for-pybossa">Configuring nginx and uwsgi for PYBOSSA</h2>
<p>We assume you only want to run PYBOSSA on your nginx webserver. If you
want to run also other services on the same server you need to modify
the nginx config files!</p>
<p>You have to copy and adapt the following files from your local PYBOSSA
installation:</p>
<ul>
<li>contrib/nginx/pybossa</li>
<li>contrib/pybossa.ini</li>
</ul>
<p>The PYBOSSA virtual host file (<strong>contrib/nginx/pybossa</strong>) has the
following directives:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">location</span> <span class="o">/</span> <span class="p">{</span> <span class="err">try_files</span> <span class="err">$uri</span> <span class="err">@pybossa</span><span class="p">;</span> <span class="p">}</span>

<span class="nt">location</span> <span class="p">@</span><span class="k">pybossa</span> <span class="p">{</span>
    <span class="nt">include</span> <span class="nt">uwsgi_params</span><span class="o">;</span>
    <span class="nt">uwsgi_pass</span> <span class="nt">unix</span><span class="o">:/</span><span class="nt">tmp</span><span class="o">/</span><span class="nt">pybossa</span><span class="p">.</span><span class="nc">sock</span><span class="o">;</span>
<span class="p">}</span>

<span class="nt">location</span>  <span class="o">/</span><span class="nt">static</span> <span class="p">{</span>

            <span class="err">#</span> <span class="err">change</span> <span class="err">that</span> <span class="err">to</span> <span class="err">your</span> <span class="err">pybossa</span> <span class="err">static</span> <span class="err">directory</span>
            <span class="err">alias</span> <span class="err">/home/Scifabric/pybossa/pybossa/themes/default/static</span><span class="p">;</span>

            <span class="err">autoindex</span> <span class="err">on</span><span class="p">;</span>
            <span class="err">expires</span> <span class="err">max</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>You can specify a user and group from your machine with lower privileges
in order to improve the security of the site. You can also use the
www-data user and group name.</p>
<p>Once you have adapted the PATH in the alias in that file, copy it into
the folder:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo cp contrib/nginx/pybossa /etc/nginx/sites-available/.
</pre></div>
</td></tr></table>

<p>Please delete the default config in sites-enabled (do not worry there is
a backup):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo rm /etc/nginx/sites-enabled/default
</pre></div>
</td></tr></table>

<p>Enable the PYBOSSA site:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo ln -s /etc/nginx/sites-available/pybossa /etc/nginx/sites-enabled/pybossa
</pre></div>
</td></tr></table></p>
<p>And restart the server:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo service nginx restart
</pre></div>
</td></tr></table></p>
<h2 id="creating-the-pybossaini-file-for-uwsgi">Creating the pybossa.ini file for uwsgi</h2>
<p>You have to copy the <strong>pybossa.ini.template</strong> file to pybossa.ini in
your PYBOSSA installation and adapt the paths to match your
configuration!</p>
<p>The content of this file is the following:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="n">uwsgi</span><span class="p">]</span>
<span class="n">socket</span> <span class="o">=</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">pybossa</span><span class="o">.</span><span class="n">sock</span>
<span class="n">chmod</span><span class="o">-</span><span class="n">socket</span> <span class="o">=</span> <span class="mi">666</span>
<span class="n">chdir</span> <span class="o">=</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pybossa</span><span class="o">/</span><span class="n">pybossa</span>
<span class="n">pythonpath</span> <span class="o">=</span> <span class="o">..</span>
<span class="n">virtualenv</span> <span class="o">=</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pybossa</span><span class="o">/</span><span class="n">pybossa</span><span class="o">/</span><span class="n">env</span>
<span class="n">module</span> <span class="o">=</span> <span class="n">run</span><span class="p">:</span><span class="n">app</span>
<span class="n">cpu</span><span class="o">-</span><span class="n">affinity</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">processes</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">threads</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">stats</span> <span class="o">=</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">pybossa</span><span class="o">-</span><span class="n">stats</span><span class="o">.</span><span class="n">sock</span>
<span class="nb">buffer</span><span class="o">-</span><span class="n">size</span> <span class="o">=</span> <span class="mi">65535</span>
</pre></div>
</td></tr></table>

<h2 id="install-supervisord">Install supervisord</h2>
<p>Supervisord is used to let PYBOSSA and its RQ system run as Daemon in
the background. It shares some of the same goals of programs like
launchd, daemontools, and runit.</p>
<p>Install it:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo apt-get install supervisor
</pre></div>
</td></tr></table></p>
<h2 id="configure-redis-and-sentinel-as-service-with-supervisord">Configure Redis and sentinel as service with supervisord</h2>
<p>First stop redis service and all running redis instances with:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo service redis-server stop
killall redis-server
</pre></div>
</td></tr></table>

<p>We want to run redis and sentinel with supervisord because supervisord
is more reliable when redis crashes (which can happen when you have too
less memory). So we disable redis-server daemon service with:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo rm /etc/init.d/redis-server
</pre></div>
</td></tr></table>

<p>Go to your pybossa installation directory and copy following files:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo cp contrib/supervisor/redis-server.conf /etc/supervisor/conf.d/
sudo cp contrib/supervisor/redis-sentinel.conf /etc/supervisor/conf.d/
sudo cp contrib/redis-supervisor/redis.conf /etc/redis/
sudo cp contrib/redis-supervisor/sentinel.conf /etc/redis/
sudo chown redis:redis /etc/redis/redis.conf
sudo chown redis:redis /etc/redis/sentinel.conf
</pre></div>
</td></tr></table>

<p>Now we restart supervisord (please do a full stop and start as
described):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo service supervisor stop
sudo service supervisor start
</pre></div>
</td></tr></table>

<p>To verify install you can list all redis processes and you should see a
redis-server at port 6379 and redis-sentinel at port 26379:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>ps aux <span class="p">|</span> grep redis
</pre></div>
</td></tr></table>

<p>This two services will no run whenever the server is running (even after
reboot).</p>
<h2 id="configure-rq-scheduler-and-worker-to-run-with-supervisord">Configure RQ-Scheduler and -Worker to run with supervisord</h2>
<p>You need to adjust the paths and user account in this two config files
according to your installation! Then copy them to supervisor (do not
forget to edit them):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo cp contrib/supervisor/rq-scheduler.conf.template /etc/supervisor/conf.d/rq-scheduler.conf
sudo cp contrib/supervisor/rq-worker.conf.template /etc/supervisor/conf.d/rq-worker.conf
</pre></div>
</td></tr></table>

<p>Restart supervisor fully:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo service supervisor stop
sudo service supervisor start
</pre></div>
</td></tr></table></p>
<p>Verify service running. You should see a rqworker and rqscheduler
instance in console:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>ps aux <span class="p">|</span> grep rq
</pre></div>
</td></tr></table>

<h2 id="setup-pybossa-itself">Setup PYBOSSA itself</h2>
<p>This steps are recommended to do when you run PYBOSSA in nginx. Open
your <strong>settings_local.py</strong> in your PYBOSSA installation and uncomment
or delete the two lines with <strong>HOST</strong> and <strong>PORT</strong>, e.g.:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># HOST = &#39;0.0.0.0&#39;</span>
<span class="c1"># PORT = 12000</span>
</pre></div>
</td></tr></table>

<p>After that specify the full server URL where your PYBOSSA is reachable,
e.g.:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">SERVER_NAME</span> <span class="o">=</span> <span class="n">mypybossa</span><span class="o">.</span><span class="n">com</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">80</span>
</pre></div>
</td></tr></table>

<h2 id="let-pybossa-run-as-service">Let PYBOSSA run as service</h2>
<p>Finally we need to let pybossa run as service. Adjust again the paths
and user name in this file and copy it to supervisor config directory:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo cp contrib/supervisor/pybossa.conf.template /etc/supervisor/conf.d/pybossa.conf
</pre></div>
</td></tr></table>

<p>Edit now the file and adjust paths &amp; user name.</p>
<p>Restart supervisor fully:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo service supervisor stop
sudo service supervisor start
</pre></div>
</td></tr></table></p>
<p>You should now have a running PYBOSSA production ready webserver on your
nginx. Open your browser and check your configured domain
<a href="http://example.com">http://example.com</a>.</p>
<p>Congratulations! <img alt="😄" class="emojione" src="https://cdn.jsdelivr.net/emojione/assets/svg/1f604.svg" title=":smile:" /></p>
<h2 id="how-to-update-pybossa-service">How to update PYBOSSA service</h2>
<p>Upgrading and updating PYBOSSA as service works the same as for a
standalone version. Please follow instructions on install. However a few
extra steps are required after you updated.</p>
<p>You need to restart all supervisor controlled services after updating:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>sudo supervisorctl restart rq-scheduler
sudo supervisorctl restart rq-worker
sudo supervisorctl restart pybossa
</pre></div>
</td></tr></table>

<h2 id="logs-of-pybossa-services">Logs of PYBOSSA services</h2>
<p>You can find logs of all PYBOSSA services in this directory:
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">cd</span> /var/log/supervisor
</pre></div>
</td></tr></table></p>
<h2 id="last-words-about-security-and-scaling">Last words about Security and Scaling</h2>
<p>This guide does not cover how to secure your PYBOSSA installation. As
every web server you have to make it secure (like e.g. strong passwords,
automatic Ubuntu security updates, firewall, access restrictions).
Please use guides on the Internet to do so.</p>
<p>PYBOSSA can also be scaled horizontally to run with redundant servers
and with zero downtime over many redis, db and web servers with load
balancers in between.</p>
<p>If you need a secure and/or scalable PYBOSSA installation please contact
us. We will be glad to help you and we can even do all the hosting,
customization, administration and installation for you. Check our 
<a href="https://scifabric.com/pricing/">pricing page</a> and get in touch.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../model/" title="Model" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Model
              </span>
            </div>
          </a>
        
        
          <a href="../overview/" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright © 2017 <a href="https://scifabric.com">Scifabric</a>
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/Scifabric" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/Scifabric" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-f3ab9e5ff8.js"></script>
      
      
      <script>app.initialize({url:{base:".."}})</script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-49052879-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>